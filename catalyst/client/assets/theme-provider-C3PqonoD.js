import{p as se,r as s,h as S,R as L,j as ce,C as Ce}from"./index-DY4lwpwP.js";import{T as ke}from"./theme-context-CYHh4AWr.js";var D={},B;function we(){if(B)return D;B=1,D.match=i,D.parse=u;var e=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,t=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,n=/^(?:(min|max)-)?(.+)/,r=/(em|rem|px|cm|mm|in|pt|pc)?$/,a=/(dpi|dpcm|dppx)?$/;function i(p,c){return u(p).some(function(m){var o=m.inverse,E=m.type==="all"||c.type===m.type;if(E&&o||!(E||o))return!1;var k=m.expressions.every(function(y){var C=y.feature,O=y.modifier,v=y.value,g=c[C];if(!g)return!1;switch(C){case"orientation":case"scan":return g.toLowerCase()===v.toLowerCase();case"width":case"height":case"device-width":case"device-height":v=d(v),g=d(g);break;case"resolution":v=l(v),g=l(g);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":v=h(v),g=h(g);break;case"grid":case"color":case"color-index":case"monochrome":v=parseInt(v,10)||1,g=parseInt(g,10)||0;break}switch(O){case"min":return g>=v;case"max":return g<=v;default:return g===v}});return k&&!o||!k&&o})}function u(p){return p.split(",").map(function(c){c=c.trim();var m=c.match(e),o=m[1],E=m[2],k=m[3]||"",y={};return y.inverse=!!o&&o.toLowerCase()==="not",y.type=E?E.toLowerCase():"all",k=k.match(/\([^\)]+\)/g)||[],y.expressions=k.map(function(C){var O=C.match(t),v=O[1].toLowerCase().match(n);return{modifier:v[1],feature:v[2],value:O[2]}}),y})}function h(p){var c=Number(p),m;return c||(m=p.match(/^(\d+)\s*\/\s*(\d+)$/),c=m[1]/m[2]),c}function l(p){var c=parseFloat(p),m=String(p).match(a)[1];switch(m){case"dpcm":return c/2.54;case"dppx":return c*96;default:return c}}function d(p){var c=parseFloat(p),m=String(p).match(r)[1];switch(m){case"em":return c*16;case"rem":return c*16;case"cm":return c*96/2.54;case"mm":return c*96/2.54/10;case"in":return c*96;case"pt":return c*72;case"pc":return c*72/12;default:return c}}return D}var I,Q;function Ee(){if(Q)return I;Q=1;var e=we().match,t=typeof window<"u"?window.matchMedia:null;function n(a,i,u){var h=this,l;t&&!u&&(l=t.call(window,a)),l?(this.matches=l.matches,this.media=l.media,l.addListener(c)):(this.matches=e(a,i),this.media=a),this.addListener=d,this.removeListener=p,this.dispose=m;function d(o){l&&l.addListener(o)}function p(o){l&&l.removeListener(o)}function c(o){h.matches=o.matches,h.media=o.media}function m(){l&&l.removeListener(c)}}function r(a,i,u){return new n(a,i,u)}return I=r,I}var Se=Ee();const Le=se(Se);var _e=/[A-Z]/g,Me=/^ms-/,A={};function Oe(e){return"-"+e.toLowerCase()}function ue(e){if(A.hasOwnProperty(e))return A[e];var t=e.replace(_e,Oe);return A[e]=Me.test(t)?"-"+t:t}function Re(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=Object.keys(e),r=Object.keys(t),a=n.length;if(r.length!==a)return!1;for(let i=0;i<a;i++){const u=n[i];if(e[u]!==t[u]||!Object.prototype.hasOwnProperty.call(t,u))return!1}return!0}var W={exports:{}},H,V;function xe(){if(V)return H;V=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return H=e,H}var K,$;function Te(){if($)return K;$=1;var e=xe();function t(){}function n(){}return n.resetWarningCache=t,K=function(){function r(u,h,l,d,p,c){if(c!==e){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}r.isRequired=r;function a(){return r}var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return i.PropTypes=i,i},K}var Z;function Pe(){return Z||(Z=1,W.exports=Te()()),W.exports}var De=Pe();const f=se(De),w=f.oneOfType([f.string,f.number]),le={all:f.bool,grid:f.bool,aural:f.bool,braille:f.bool,handheld:f.bool,print:f.bool,projection:f.bool,screen:f.bool,tty:f.bool,tv:f.bool,embossed:f.bool},Ie={orientation:f.oneOf(["portrait","landscape"]),scan:f.oneOf(["progressive","interlace"]),aspectRatio:f.string,deviceAspectRatio:f.string,height:w,deviceHeight:w,width:w,deviceWidth:w,color:f.bool,colorIndex:f.bool,monochrome:f.bool,resolution:w,type:Object.keys(le)},{type:vt,...Ae}=Ie,We={minAspectRatio:f.string,maxAspectRatio:f.string,minDeviceAspectRatio:f.string,maxDeviceAspectRatio:f.string,minHeight:w,maxHeight:w,minDeviceHeight:w,maxDeviceHeight:w,minWidth:w,maxWidth:w,minDeviceWidth:w,maxDeviceWidth:w,minColor:f.number,maxColor:f.number,minColorIndex:f.number,maxColorIndex:f.number,minMonochrome:f.number,maxMonochrome:f.number,minResolution:w,maxResolution:w,...Ae},He={...le,...We};var Ke={all:He};const qe=e=>`not ${e}`,Fe=(e,t)=>{const n=ue(e);return typeof t=="number"&&(t=`${t}px`),t===!0?n:t===!1?qe(n):`(${n}: ${t})`},Ne=e=>e.join(" and "),je=e=>{const t=[];return Object.keys(Ke.all).forEach(n=>{const r=e[n];r!=null&&t.push(Fe(n,r))}),Ne(t)},Ue=s.createContext(void 0),Ge=e=>e.query||je(e),z=e=>e?Object.keys(e).reduce((n,r)=>(n[ue(r)]=e[r],n),{}):void 0,fe=()=>{const e=s.useRef(!1);return s.useEffect(()=>{e.current=!0},[]),e.current},Be=e=>{const t=s.useContext(Ue),n=()=>z(e)||z(t),[r,a]=s.useState(n);return s.useEffect(()=>{const i=n();Re(r,i)||a(i)},[e,t]),r},Qe=e=>{const t=()=>Ge(e),[n,r]=s.useState(t);return s.useEffect(()=>{const a=t();n!==a&&r(a)},[e]),n},Ve=(e,t)=>{const n=()=>Le(e,t||{},!!t),[r,a]=s.useState(n),i=fe();return s.useEffect(()=>{if(i){const u=n();return a(u),()=>{u&&u.dispose()}}},[e,t]),r},$e=e=>{const[t,n]=s.useState(e.matches);return s.useEffect(()=>{const r=a=>{n(a.matches)};return e.addListener(r),n(e.matches),()=>{e.removeListener(r)}},[e]),t},Ze=(e,t,n)=>{const r=Be(t),a=Qe(e);if(!a)throw new Error("Invalid or missing MediaQuery!");const i=Ve(a,r),u=$e(i);return fe(),s.useEffect(()=>{},[u]),s.useEffect(()=>()=>{i&&i.dispose()},[]),u},me=s.createContext({theme:"system",setTheme:S,scrollAction:"pan",setScrollAction:S,showDBViews:!1,setShowDBViews:S,showCardinality:!0,setShowCardinality:S,showFieldAttributes:!0,setShowFieldAttributes:S,githubRepoOpened:!1,setGithubRepoOpened:S,starUsDialogLastOpen:0,setStarUsDialogLastOpen:S,showMiniMapOnCanvas:!1,setShowMiniMapOnCanvas:S}),ze=()=>s.useContext(me),Y="theme",X="scroll_action",J="show_cardinality",Ye="show_field_attributes",ee="github_repo_opened",te="star_us_dialog_last_open",ne="show_minimap_on_canvas",re="show_db_views",gt=({children:e})=>{const[t,n]=L.useState(localStorage.getItem(Y)||"system"),[r,a]=L.useState(localStorage.getItem(X)||"pan"),[i,u]=L.useState((localStorage.getItem(re)||"false")==="true"),[h,l]=L.useState((localStorage.getItem(J)||"true")==="true"),[d,p]=L.useState((localStorage.getItem(Ye)||"true")==="true"),[c,m]=L.useState((localStorage.getItem(ee)||"false")==="true"),[o,E]=L.useState(parseInt(localStorage.getItem(te)||"0")),[k,y]=L.useState((localStorage.getItem(ne)||"true")==="true");return s.useEffect(()=>{localStorage.setItem(te,o.toString())},[o]),s.useEffect(()=>{localStorage.setItem(ee,c.toString())},[c]),s.useEffect(()=>{localStorage.setItem(Y,t)},[t]),s.useEffect(()=>{localStorage.setItem(X,r)},[r]),s.useEffect(()=>{localStorage.setItem(re,i.toString())},[i]),s.useEffect(()=>{localStorage.setItem(J,h.toString())},[h]),s.useEffect(()=>{localStorage.setItem(ne,k.toString())},[k]),ce.jsx(me.Provider,{value:{theme:t,setTheme:n,scrollAction:r,setScrollAction:a,showDBViews:i,setShowDBViews:u,showCardinality:h,setShowCardinality:l,showFieldAttributes:d,setShowFieldAttributes:p,setGithubRepoOpened:m,githubRepoOpened:c,starUsDialogLastOpen:o,setStarUsDialogLastOpen:E,showMiniMapOnCanvas:k,setShowMiniMapOnCanvas:y},children:e})};function N(){return N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N.apply(null,arguments)}var de=["shift","alt","meta","mod","ctrl"],Xe={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function _(e){return(e&&Xe[e]||e||"").trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function Je(e){return de.includes(e)}function q(e,t){return t===void 0&&(t=","),e.split(t)}function F(e,t,n){t===void 0&&(t="+");var r=e.toLocaleLowerCase().split(t).map(function(u){return _(u)}),a={alt:r.includes("alt"),ctrl:r.includes("ctrl")||r.includes("control"),shift:r.includes("shift"),meta:r.includes("meta"),mod:r.includes("mod")},i=r.filter(function(u){return!de.includes(u)});return N({},a,{keys:i,description:n,hotkey:e})}(function(){typeof document<"u"&&(document.addEventListener("keydown",function(e){e.key!==void 0&&pe([_(e.key),_(e.code)])}),document.addEventListener("keyup",function(e){e.key!==void 0&&he([_(e.key),_(e.code)])})),typeof window<"u"&&window.addEventListener("blur",function(){M.clear()})})();var M=new Set;function j(e){return Array.isArray(e)}function et(e,t){t===void 0&&(t=",");var n=j(e)?e:e.split(t);return n.every(function(r){return M.has(r.trim().toLowerCase())})}function pe(e){var t=Array.isArray(e)?e:[e];M.has("meta")&&M.forEach(function(n){return!Je(n)&&M.delete(n.toLowerCase())}),t.forEach(function(n){return M.add(n.toLowerCase())})}function he(e){var t=Array.isArray(e)?e:[e];e==="meta"?M.clear():t.forEach(function(n){return M.delete(n.toLowerCase())})}function tt(e,t,n){(typeof n=="function"&&n(e,t)||n===!0)&&e.preventDefault()}function nt(e,t,n){return typeof n=="function"?n(e,t):n===!0||n===void 0}function rt(e){return ye(e,["input","textarea","select"])}function ye(e,t){t===void 0&&(t=!1);var n=e.target,r=e.composed,a=null;return ot(n)&&r?a=e.composedPath()[0]&&e.composedPath()[0].tagName:a=n&&n.tagName,j(t)?!!(a&&t&&t.some(function(i){var u;return i.toLowerCase()===((u=a)==null?void 0:u.toLowerCase())})):!!(a&&t&&t)}function ot(e){return!!e.tagName&&!e.tagName.startsWith("-")&&e.tagName.includes("-")}function at(e,t){return e.length===0&&t?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):t?e.some(function(n){return t.includes(n)})||e.includes("*"):!0}var it=function(t,n,r){r===void 0&&(r=!1);var a=n.alt,i=n.meta,u=n.mod,h=n.shift,l=n.ctrl,d=n.keys,p=t.key,c=t.code,m=t.ctrlKey,o=t.metaKey,E=t.shiftKey,k=t.altKey,y=_(c),C=p.toLowerCase();if(!(d!=null&&d.includes(y))&&!(d!=null&&d.includes(C))&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(y))return!1;if(!r){if(a===!k&&C!=="alt"||h===!E&&C!=="shift")return!1;if(u){if(!o&&!m)return!1}else if(i===!o&&C!=="meta"&&C!=="os"||l===!m&&C!=="ctrl"&&C!=="control")return!1}return d&&d.length===1&&(d.includes(C)||d.includes(y))?!0:d?et(d):!d},st=s.createContext(void 0),ct=function(){return s.useContext(st)};function ve(e,t){return e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce(function(n,r){return n&&ve(e[r],t[r])},!0):e===t}var ut=s.createContext({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),lt=function(){return s.useContext(ut)};function ft(e){var t=s.useRef(void 0);return ve(t.current,e)||(t.current=e),t.current}var oe=function(t){t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation()},mt=typeof window<"u"?s.useLayoutEffect:s.useEffect;function dt(e,t,n,r){var a=s.useState(null),i=a[0],u=a[1],h=s.useRef(!1),l=n instanceof Array?r instanceof Array?void 0:r:n,d=j(e)?e.join(l?.splitKey):e,p=n instanceof Array?n:r instanceof Array?r:void 0,c=s.useCallback(t,p??[]),m=s.useRef(c);p?m.current=c:m.current=t;var o=ft(l),E=lt(),k=E.enabledScopes,y=ct();return mt(function(){if(!(o?.enabled===!1||!at(k,o?.scopes))){var C=function(b,T){var U;if(T===void 0&&(T=!1),!(rt(b)&&!ye(b,o?.enableOnFormTags))){if(i!==null){var P=i.getRootNode();if((P instanceof Document||P instanceof ShadowRoot)&&P.activeElement!==i&&!i.contains(P.activeElement)){oe(b);return}}(U=b.target)!=null&&U.isContentEditable&&!(o!=null&&o.enableOnContentEditable)||q(d,o?.splitKey).forEach(function(be){var G,x=F(be,o?.combinationKey);if(it(b,x,o?.ignoreModifiers)||(G=x.keys)!=null&&G.includes("*")){if(o!=null&&o.ignoreEventWhen!=null&&o.ignoreEventWhen(b)||T&&h.current)return;if(tt(b,x,o?.preventDefault),!nt(b,x,o?.enabled)){oe(b);return}m.current(b,x),T||(h.current=!0)}})}},O=function(b){b.key!==void 0&&(pe(_(b.code)),(o?.keydown===void 0&&o?.keyup!==!0||o!=null&&o.keydown)&&C(b))},v=function(b){b.key!==void 0&&(he(_(b.code)),h.current=!1,o!=null&&o.keyup&&C(b,!0))},g=i||l?.document||document;return g.addEventListener("keyup",v,l?.eventListenerOptions),g.addEventListener("keydown",O,l?.eventListenerOptions),y&&q(d,o?.splitKey).forEach(function(R){return y.addHotkey(F(R,o?.combinationKey,o?.description))}),function(){g.removeEventListener("keyup",v,l?.eventListenerOptions),g.removeEventListener("keydown",O,l?.eventListenerOptions),y&&q(d,o?.splitKey).forEach(function(R){return y.removeHotkey(F(R,o?.combinationKey,o?.description))})}}},[i,d,o,k]),u}var ge=(e=>(e.REDO="redo",e.UNDO="undo",e.OPEN_DIAGRAM="open_diagram",e.SAVE_DIAGRAM="save_diagram",e.TOGGLE_SIDE_PANEL="toggle_side_panel",e.SHOW_ALL="show_all",e.TOGGLE_THEME="toggle_theme",e.TOGGLE_FILTER="toggle_filter",e))(ge||{});const ae={redo:{action:"redo",keyCombinationLabelMac:"⇧⌘Z",keyCombinationLabelWin:"Ctrl+Shift+Z",keyCombinationMac:"meta+shift+z",keyCombinationWin:"ctrl+shift+z"},undo:{action:"undo",keyCombinationLabelMac:"⌘Z",keyCombinationLabelWin:"Ctrl+Z",keyCombinationMac:"meta+z",keyCombinationWin:"ctrl+z"},open_diagram:{action:"open_diagram",keyCombinationLabelMac:"⌘O",keyCombinationLabelWin:"Ctrl+O",keyCombinationMac:"meta+o",keyCombinationWin:"ctrl+o"},save_diagram:{action:"save_diagram",keyCombinationLabelMac:"⌘S",keyCombinationLabelWin:"Ctrl+S",keyCombinationMac:"meta+s",keyCombinationWin:"ctrl+s"},toggle_side_panel:{action:"toggle_side_panel",keyCombinationLabelMac:"⌘B",keyCombinationLabelWin:"Ctrl+B",keyCombinationMac:"meta+b",keyCombinationWin:"ctrl+b"},show_all:{action:"show_all",keyCombinationLabelMac:"⌘0",keyCombinationLabelWin:"Ctrl+0",keyCombinationMac:"meta+0",keyCombinationWin:"ctrl+0"},toggle_theme:{action:"toggle_theme",keyCombinationLabelMac:"⌘M",keyCombinationLabelWin:"Ctrl+M",keyCombinationMac:"meta+m",keyCombinationWin:"ctrl+m"},toggle_filter:{action:"toggle_filter",keyCombinationLabelMac:"⌘F",keyCombinationLabelWin:"Ctrl+F",keyCombinationMac:"meta+f",keyCombinationWin:"ctrl+f"}},ie=Ce(),pt=Object.keys(ae).reduce((e,t)=>{const n=ae[t],r=ie==="mac"?n.keyCombinationLabelMac:n.keyCombinationLabelWin,a=ie==="mac"?n.keyCombinationMac:n.keyCombinationWin;return{...e,[t]:{action:n.action,keyCombinationLabel:r,keyCombination:a}}},{}),bt=({children:e})=>{const{theme:t,setTheme:n}=ze(),a=Ze({query:"(prefers-color-scheme: dark)"})?"dark":"light",[i,u]=s.useState(a);s.useEffect(()=>{u(t==="system"?a:t)},[t,a]),s.useEffect(()=>{i==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[i]);const h=s.useCallback(()=>{n(t==="system"?i==="dark"?"light":"dark":t==="dark"?"light":"dark")},[t,i,n]);return dt(pt[ge.TOGGLE_THEME].keyCombination,h,{preventDefault:!0,enableOnFormTags:!0},[h]),ce.jsx(ke.Provider,{value:{theme:t,setTheme:n,effectiveTheme:i},children:e})};export{ge as K,gt as L,bt as T,Ze as a,dt as b,pt as k,ze as u};
