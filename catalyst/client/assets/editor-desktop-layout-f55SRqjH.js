const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/es-DHRdNV8D.js","assets/index-DY4lwpwP.js","assets/index-DpOfNa5w.css","assets/fr-u2i_LzAf.js","assets/de-Bzr9sihJ.js","assets/hi_IN-MJkcqMf7.js","assets/ja-DChRef--.js","assets/ko-BI4MjW9t.js","assets/ru-Crc23cPd.js","assets/zh_CN-BNAMiZ1h.js","assets/zh_TW-BadKDJYL.js","assets/pt_BR-dc9GszXj.js","assets/bn_IN-CVM7j7jI.js","assets/en_US-DMMsnAZc.js"])))=>i.map(i=>d[i]);
import{r as x,j as t,T as m,c as h,e as f,_ as l,a as L,u as $,d as V}from"./index-DY4lwpwP.js";import{U as H,D as B,a as W,A as v,b as j,c as G,d as q,e as D,f as g,g as F,R as Z,h as T,i as K}from"./editor-page-DBwrEL6D.js";import{M as Y,D as J,L as Q,S as X,E as ee,a as te}from"./menu-CMgKE8zW.js";import{C as ae}from"./canvas-DNr_NzL_.js";import{e as M,f as re,g as se,u as ne}from"./create-relationship-node-BYICOGVW.js";import{C as ie,a as oe}from"./logo-light-BFt8fYOX.js";import{u as le}from"./use-theme-2X7Juh3D.js";import{B as ce}from"./badge-C_-_NdiN.js";import{u as de}from"./use-toast-CCsW8X7b.js";import{c}from"./spinner-CVTCfUTm.js";import{B as p}from"./label-BRUqhX6x.js";import"./theme-provider-C3PqonoD.js";import"./theme-context-CYHh4AWr.js";import"./hybrid-storage-provider-DmYvaGnN.js";import"./use-storage-CxHm3ldK.js";import"./database-edition-CVGqoTM3.js";import"./databases-DbMVk969.js";import"./code-editor-CnstDFjw.js";import"./input-BPPsHut0.js";import"./diagram-icon-tBo8msAN.js";import"./textarea-WOrfQulB.js";import"./import-y0RA8y2U.js";const ue=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],me=c("activity",ue);const he=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],fe=c("log-in",he);const _e=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],xe=c("log-out",_e);const pe=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ge=c("save",pe);const ve=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],je=c("settings",ve);const ye=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Ne=c("share-2",ye);const be=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],we=c("user",be);const ke=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],De=c("wifi-off",ke);const Te=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],E=c("wifi",Te);var Ee=["second","minute","hour","day","week","month","year"];function ze(e,a){if(a===0)return["just now","right now"];var s=Ee[Math.floor(a/2)];return e>1&&(s+="s"),[e+" "+s+" ago","in "+e+" "+s]}var Ce=["秒","分钟","小时","天","周","个月","年"];function Le(e,a){if(a===0)return["刚刚","片刻后"];var s=Ce[~~(a/2)];return[e+" "+s+"前",e+" "+s+"后"]}var y={},w=function(e,a){y[e]=a},S=function(e){return y[e]||y.en_US},u=[60,60,24,7,365/7/12,12];function z(e){return e instanceof Date?e:!isNaN(e)||/^\d+$/.test(e)?new Date(parseInt(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(e))}function A(e,a){var s=e<0?1:0;e=Math.abs(e);for(var r=e,n=0;e>=u[n]&&n<u.length;n++)e/=u[n];return e=Math.floor(e),n*=2,e>(n===0?9:1)&&(n+=1),a(e,n,r)[s].replace("%s",e.toString())}function O(e,a){var s=a?z(a):new Date;return(+s-+z(e))/1e3}function Me(e){for(var a=1,s=0,r=Math.abs(e);e>=u[s]&&s<u.length;s++)e/=u[s],a*=u[s];return r=r%a,r=r?a-r:a,Math.ceil(r)}var Se=function(e,a,s){var r=O(e,s&&s.relativeDate);return A(r,S(a))},I="timeago-id";function Ae(e){return e.getAttribute("datetime")}function Oe(e,a){e.setAttribute(I,a)}function P(e){return parseInt(e.getAttribute(I))}var k={},N=function(e){clearTimeout(e),delete k[e]};function R(e,a,s,r){N(P(e));var n=r.relativeDate,i=r.minInterval,o=O(a,n);e.innerText=A(o,s);var d=setTimeout(function(){R(e,a,s,r)},Math.min(Math.max(Me(o),i||1)*1e3,2147483647));k[d]=0,Oe(e,d)}function C(e){e?N(P(e)):Object.keys(k).forEach(N)}function Ie(e,a,s){var r=e.length?e:[e];return r.forEach(function(n){R(n,Ae(n),S(a),s||{})}),r}w("en_US",ze);w("zh_CN",Le);var Pe=(function(){var e=function(a,s){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},e(a,s)};return function(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");e(a,s);function r(){this.constructor=a}a.prototype=s===null?Object.create(s):(r.prototype=s.prototype,new r)}})(),b=function(){return b=Object.assign||function(e){for(var a,s=1,r=arguments.length;s<r;s++){a=arguments[s];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},b.apply(this,arguments)},Re=function(e,a){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&a.indexOf(r)<0&&(s[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)a.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(s[r[n]]=e[r[n]]);return s},Ue=function(e){return""+(e instanceof Date?e.getTime():e)},$e=(function(e){Pe(a,e);function a(){var s=e!==null&&e.apply(this,arguments)||this;return s.dom=null,s}return a.prototype.componentDidMount=function(){this.renderTimeAgo()},a.prototype.componentDidUpdate=function(){this.renderTimeAgo()},a.prototype.renderTimeAgo=function(){var s=this.props,r=s.live,n=s.datetime,i=s.locale,o=s.opts;C(this.dom),r!==!1&&(this.dom.setAttribute("datetime",Ue(n)),Ie(this.dom,i,o))},a.prototype.componentWillUnmount=function(){C(this.dom)},a.prototype.render=function(){var s=this,r=this.props,n=r.datetime;r.live;var i=r.locale,o=r.opts,d=Re(r,["datetime","live","locale","opts"]);return x.createElement("time",b({ref:function(_){s.dom=_}},d),Se(n,i,o))},a.defaultProps={live:!0,className:""},a})(x.PureComponent);const Ve=async e=>{let a,s;switch(e){case"es":a=(await l(async()=>{const{default:r}=await import("./es-DHRdNV8D.js").then(n=>n.e);return{default:r}},__vite__mapDeps([0,1,2]))).default,s="es";break;case"fr":a=(await l(async()=>{const{default:r}=await import("./fr-u2i_LzAf.js").then(n=>n.f);return{default:r}},__vite__mapDeps([3,1,2]))).default,s="fr";break;case"de":a=(await l(async()=>{const{default:r}=await import("./de-Bzr9sihJ.js").then(n=>n.d);return{default:r}},__vite__mapDeps([4,1,2]))).default,s="de";break;case"hi":a=(await l(async()=>{const{default:r}=await import("./hi_IN-MJkcqMf7.js").then(n=>n.h);return{default:r}},__vite__mapDeps([5,1,2]))).default,s="hi_IN";break;case"ja":a=(await l(async()=>{const{default:r}=await import("./ja-DChRef--.js").then(n=>n.j);return{default:r}},__vite__mapDeps([6,1,2]))).default,s="ja";break;case"ko_KR":a=(await l(async()=>{const{default:r}=await import("./ko-BI4MjW9t.js").then(n=>n.k);return{default:r}},__vite__mapDeps([7,1,2]))).default,s="ko";break;case"ru":a=(await l(async()=>{const{default:r}=await import("./ru-Crc23cPd.js").then(n=>n.r);return{default:r}},__vite__mapDeps([8,1,2]))).default,s="ru";break;case"zh_CN":a=(await l(async()=>{const{default:r}=await import("./zh_CN-BNAMiZ1h.js").then(n=>n.z);return{default:r}},__vite__mapDeps([9,1,2]))).default,s="zh_CN";break;case"zh_TW":a=(await l(async()=>{const{default:r}=await import("./zh_TW-BadKDJYL.js").then(n=>n.z);return{default:r}},__vite__mapDeps([10,1,2]))).default,s="zh_TW";break;case"pt_BR":a=(await l(async()=>{const{default:r}=await import("./pt_BR-dc9GszXj.js").then(n=>n.p);return{default:r}},__vite__mapDeps([11,1,2]))).default,s="pt_BR";break;case"bn":a=(await l(async()=>{const{default:r}=await import("./bn_IN-CVM7j7jI.js").then(n=>n.b);return{default:r}},__vite__mapDeps([12,1,2]))).default,s="bn";break;default:a=(await l(async()=>{const{default:r}=await import("./en_US-DMMsnAZc.js").then(n=>n.e);return{default:r}},__vite__mapDeps([13,1,2]))).default,s="en_US";break}return{locale:a,lang:s}},He=()=>{const{currentDiagram:e}=M(),{i18n:a}=de(),[s,r]=x.useState("en_US");return x.useEffect(()=>{(async()=>{const{locale:i,lang:o}=await Ve(a.language);w(a.language,i),r(o)})()},[a.language]),t.jsxs(m,{children:[t.jsx(h,{children:t.jsxs(ce,{variant:"secondary",className:"flex gap-1.5 whitespace-nowrap",children:[t.jsx(ge,{size:16}),t.jsx($e,{datetime:e.updatedAt,locale:s})]})}),t.jsx(f,{children:e.updatedAt.toLocaleString()})]})},Be=()=>{const{user:e,isAuthenticated:a,logout:s,isLoading:r}=L(),n=$(),i=()=>{s(),n("/")},o=()=>{n("/login")},d=()=>{n("/register")};if(!a)return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(p,{variant:"ghost",size:"sm",onClick:o,disabled:r,children:[t.jsx(fe,{className:"mr-2 size-4"}),"Sign In"]}),t.jsxs(p,{size:"sm",onClick:d,disabled:r,children:[t.jsx(H,{className:"mr-2 size-4"}),"Sign Up"]})]});const _=e?`${e.firstName?.[0]||""}${e.lastName?.[0]||""}`.toUpperCase()||e.email[0].toUpperCase():"?",U=e?`${e.firstName||""} ${e.lastName||""}`.trim()||e.email:"User";return t.jsxs(B,{children:[t.jsx(W,{asChild:!0,children:t.jsx(p,{variant:"ghost",className:"relative size-8 rounded-full",children:t.jsx(v,{className:"size-8",children:t.jsx(j,{className:"bg-primary text-primary-foreground",children:_})})})}),t.jsxs(G,{className:"w-56",align:"end",forceMount:!0,children:[t.jsx(q,{className:"font-normal",children:t.jsxs("div",{className:"flex flex-col space-y-1",children:[t.jsx("p",{className:"text-sm font-medium leading-none",children:U}),t.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:e?.email})]})}),t.jsx(D,{}),t.jsxs(g,{onClick:()=>n("/profile"),children:[t.jsx(we,{className:"mr-2 size-4"}),t.jsx("span",{children:"Profile"})]}),t.jsxs(g,{onClick:()=>n("/settings"),children:[t.jsx(je,{className:"mr-2 size-4"}),t.jsx("span",{children:"Settings"})]}),t.jsx(D,{}),t.jsxs(g,{onClick:i,className:"text-destructive",children:[t.jsx(xe,{className:"mr-2 size-4"}),t.jsx("span",{children:"Log out"})]})]})]})},We=e=>{let a=0;for(let r=0;r<e.length;r++)a=e.charCodeAt(r)+((a<<5)-a);return`hsl(${a%360}, 70%, 50%)`},Ge=e=>e<0?"text-muted-foreground":e<100?"text-green-500":e<300?"text-yellow-500":"text-red-500",qe=()=>{const{isConnected:e,isConnecting:a,activeUsers:s,currentDiagramId:r,latency:n}=re();return r?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(m,{children:[t.jsx(h,{asChild:!0,children:t.jsx("div",{className:"flex items-center",children:a?t.jsx(E,{className:"size-4 animate-pulse text-yellow-500"}):e?t.jsx(E,{className:"size-4 text-green-500"}):t.jsx(De,{className:"size-4 text-destructive"})})}),t.jsx(f,{children:a?"Connecting...":e?"Real-time collaboration active":"Not connected"})]}),e&&n>=0&&t.jsxs(m,{children:[t.jsx(h,{asChild:!0,children:t.jsxs("div",{className:`flex items-center gap-1 ${Ge(n)}`,children:[t.jsx(me,{className:"size-3"}),t.jsxs("span",{className:"text-xs font-medium tabular-nums",children:[n,"ms"]})]})}),t.jsx(f,{children:t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-medium",children:"Server Latency"}),t.jsx("div",{className:"text-xs text-muted-foreground",children:n<100?"Excellent connection":n<300?"Good connection":"High latency"})]})})]}),s.length>0&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(F,{className:"size-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:s.length}),t.jsxs("div",{className:"ml-1 flex -space-x-2",children:[s.slice(0,5).map(i=>{const o=i.name?i.name.split(" ").map(_=>_[0]).join("").toUpperCase().slice(0,2):i.email[0].toUpperCase(),d=i.color||We(i.userId);return t.jsxs(m,{children:[t.jsx(h,{asChild:!0,children:t.jsx(v,{className:"size-6 border-2 border-background",children:t.jsx(j,{style:{backgroundColor:d},className:"text-xs text-white",children:o})})}),t.jsx(f,{children:t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-medium",children:i.name||i.email}),i.selectedElementId&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Editing:"," ",i.selectedElementId]})]})})]},i.userId)}),s.length>5&&t.jsxs(m,{children:[t.jsx(h,{asChild:!0,children:t.jsx(v,{className:"size-6 border-2 border-background",children:t.jsxs(j,{className:"bg-muted text-xs",children:["+",s.length-5]})})}),t.jsx(f,{children:t.jsx("div",{className:"text-sm",children:s.slice(5).map(i=>t.jsx("div",{children:i.name||i.email},i.userId))})})]})]})]})]}):null},Fe=()=>{const{effectiveTheme:e}=le(),{openShareDiagramDialog:a}=se(),{isAuthenticated:s}=L(),{permissionLevel:r}=M(),n=r==="OWNER",i=x.useCallback(()=>t.jsx("iframe",{src:"https://ghbtns.com/github-btn.html?user=chartdb&repo=chartdb&type=star&size=large&text=false",width:"40",height:"30",title:"GitHub"}),[]);return t.jsxs("nav",{className:"flex flex-col justify-between border-b px-3 md:h-12 md:flex-row md:items-center md:px-4",children:[t.jsxs("div",{className:"flex flex-1 flex-col justify-between gap-x-1 md:flex-row md:justify-normal",children:[t.jsx("div",{className:"flex items-center justify-between pt-[8px] font-primary md:py-[10px]",children:t.jsx("a",{href:"https://chartdb.io",className:"cursor-pointer",rel:"noreferrer",children:t.jsx("img",{src:e==="light"?ie:oe,alt:"chartDB",className:"h-4 max-w-fit"})})}),t.jsx(Y,{})]}),t.jsx(J,{}),t.jsxs("div",{className:"hidden flex-1 items-center justify-end gap-2 sm:flex",children:[t.jsx(qe,{}),s&&n&&t.jsxs(m,{children:[t.jsx(h,{asChild:!0,children:t.jsxs(p,{variant:"ghost",size:"sm",className:"gap-2",onClick:()=>a(),children:[t.jsx(Ne,{className:"size-4"}),t.jsx("span",{className:"hidden lg:inline",children:"Share"})]})}),t.jsx(f,{children:"Share diagram"})]}),t.jsx(He,{}),i(),t.jsx(Q,{}),t.jsx(Be,{})]})]})},xt=({initialDiagram:e})=>{const{isSidePanelShowed:a}=ne();return t.jsxs(t.Fragment,{children:[t.jsx(Fe,{}),t.jsxs(X,{defaultOpen:!1,open:!1,className:"h-full min-h-0",children:[t.jsx(ee,{}),t.jsxs(Z,{direction:"horizontal",children:[t.jsx(T,{defaultSize:25,minSize:25,maxSize:a?99:0,className:V("transition-[flex-grow] duration-200",{"min-w-[350px]":a}),children:t.jsx(te,{})}),t.jsx(K,{disabled:!a,className:a?"":"hidden"}),t.jsx(T,{defaultSize:75,children:t.jsx(ae,{initialTables:e?.tables??[]})})]})]})]})};export{xt as EditorDesktopLayout,xt as default};
